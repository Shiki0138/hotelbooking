<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ–°æ©Ÿèƒ½ãƒ‡ãƒ¢ - LastMinuteStay</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        // Simple Watchlist Modal Component
        const WatchlistModal = ({ isOpen, onClose, hotel, onSave }) => {
            const [priceThreshold, setPriceThreshold] = useState('');
            const [selectedDays, setSelectedDays] = useState([]);
            const [notificationChannel, setNotificationChannel] = useState('email');
            const [roomThreshold, setRoomThreshold] = useState(5);

            if (!isOpen) return null;

            const days = [
                { key: 0, label: 'æ—¥æ›œæ—¥' },
                { key: 1, label: 'æœˆæ›œæ—¥' },
                { key: 2, label: 'ç«æ›œæ—¥' },
                { key: 3, label: 'æ°´æ›œæ—¥' },
                { key: 4, label: 'æœ¨æ›œæ—¥' },
                { key: 5, label: 'é‡‘æ›œæ—¥' },
                { key: 6, label: 'åœŸæ›œæ—¥' }
            ];

            const handleDayToggle = (dayKey) => {
                setSelectedDays(prev => 
                    prev.includes(dayKey) 
                        ? prev.filter(d => d !== dayKey)
                        : [...prev, dayKey]
                );
            };

            const handleSave = () => {
                const watchlistItem = {
                    hotelId: hotel.id,
                    priceThreshold: parseFloat(priceThreshold),
                    allowedDays: selectedDays,
                    notificationChannel,
                    roomThreshold,
                    createdAt: new Date().toISOString()
                };
                onSave(watchlistItem);
            };

            return (
                <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4">
                    <div className="bg-white rounded-lg max-w-md w-full max-h-[90vh] overflow-y-auto">
                        <div className="p-6">
                            <div className="flex justify-between items-center mb-4">
                                <h3 className="text-lg font-semibold">ã‚¦ã‚©ãƒƒãƒãƒªã‚¹ãƒˆè¨­å®š</h3>
                                <button onClick={onClose} className="text-gray-400 hover:text-gray-600">
                                    âœ•
                                </button>
                            </div>

                            <div className="mb-4">
                                <h4 className="font-medium mb-2">{hotel.name}</h4>
                                <p className="text-sm text-gray-600">ç¾åœ¨ä¾¡æ ¼: Â¥{hotel.price?.toLocaleString()}</p>
                            </div>

                            <div className="space-y-4">
                                <div>
                                    <label className="block text-sm font-medium mb-1">
                                        ç›®æ¨™ä¾¡æ ¼ (å††)
                                    </label>
                                    <input
                                        type="number"
                                        value={priceThreshold}
                                        onChange={(e) => setPriceThreshold(e.target.value)}
                                        placeholder="ä¾‹: 35000"
                                        className="w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500"
                                    />
                                </div>

                                <div>
                                    <label className="block text-sm font-medium mb-2">
                                        ç›£è¦–ã™ã‚‹æ›œæ—¥
                                    </label>
                                    <div className="grid grid-cols-2 gap-2">
                                        {days.map(day => (
                                            <label key={day.key} className="flex items-center">
                                                <input
                                                    type="checkbox"
                                                    checked={selectedDays.includes(day.key)}
                                                    onChange={() => handleDayToggle(day.key)}
                                                    className="mr-2"
                                                />
                                                <span className="text-sm">{day.label}</span>
                                            </label>
                                        ))}
                                    </div>
                                </div>

                                <div>
                                    <label className="block text-sm font-medium mb-1">
                                        æ®‹å®¤æ•°ã‚¢ãƒ©ãƒ¼ãƒˆ
                                    </label>
                                    <input
                                        type="number"
                                        value={roomThreshold}
                                        onChange={(e) => setRoomThreshold(parseInt(e.target.value))}
                                        min="1"
                                        max="10"
                                        className="w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500"
                                    />
                                    <p className="text-xs text-gray-500 mt-1">æ®‹å®¤æ•°ãŒã“ã®æ•°ä»¥ä¸‹ã«ãªã£ãŸã‚‰é€šçŸ¥</p>
                                </div>

                                <div>
                                    <label className="block text-sm font-medium mb-1">
                                        é€šçŸ¥æ–¹æ³•
                                    </label>
                                    <select
                                        value={notificationChannel}
                                        onChange={(e) => setNotificationChannel(e.target.value)}
                                        className="w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500"
                                    >
                                        <option value="email">ãƒ¡ãƒ¼ãƒ«</option>
                                        <option value="push">ãƒ—ãƒƒã‚·ãƒ¥é€šçŸ¥</option>
                                        <option value="line">LINE</option>
                                        <option value="sms">SMS</option>
                                    </select>
                                </div>
                            </div>

                            <div className="mt-6 flex gap-3">
                                <button
                                    onClick={handleSave}
                                    disabled={!priceThreshold}
                                    className="flex-1 bg-blue-600 text-white py-2 px-4 rounded hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed"
                                >
                                    ã‚¦ã‚©ãƒƒãƒãƒªã‚¹ãƒˆã«è¿½åŠ 
                                </button>
                                <button
                                    onClick={onClose}
                                    className="flex-1 bg-gray-300 text-gray-700 py-2 px-4 rounded hover:bg-gray-400"
                                >
                                    ã‚­ãƒ£ãƒ³ã‚»ãƒ«
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            );
        };

        // Price Prediction Component
        const PricePrediction = ({ currentPrice, predictions }) => {
            const lowestPrice = Math.min(...predictions.map(p => p.price));
            const shouldBuyNow = currentPrice <= lowestPrice * 1.05;

            return (
                <div className="bg-white rounded-lg shadow-lg p-6">
                    <h3 className="text-xl font-bold mb-4">ä¾¡æ ¼äºˆæ¸¬ãƒ»è³¼è²·ã‚¤ãƒ³ã‚¸ã‚±ãƒ¼ã‚¿ãƒ¼</h3>
                    
                    <div className="mb-4">
                        <div className={`inline-flex items-center px-3 py-1 rounded-full text-sm font-medium ${
                            shouldBuyNow ? 'bg-green-100 text-green-800' : 'bg-yellow-100 text-yellow-800'
                        }`}>
                            {shouldBuyNow ? 'ğŸ¯ ä»ŠãŒè²·ã„æ™‚ï¼' : 'â³ ã‚‚ã†å°‘ã—å¾…ã¤ã®ã‚‚è‰¯ã„ã‹ã‚‚'}
                        </div>
                    </div>

                    <div className="space-y-2 mb-4">
                        <div className="flex justify-between">
                            <span>ç¾åœ¨ä¾¡æ ¼:</span>
                            <span className="font-semibold">Â¥{currentPrice.toLocaleString()}</span>
                        </div>
                        <div className="flex justify-between">
                            <span>äºˆæ¸¬æœ€å®‰å€¤:</span>
                            <span className="font-semibold text-green-600">Â¥{lowestPrice.toLocaleString()}</span>
                        </div>
                    </div>

                    <div className="border-t pt-4">
                        <h4 className="font-medium mb-2">7æ—¥é–“ä¾¡æ ¼äºˆæ¸¬</h4>
                        <div className="space-y-1">
                            {predictions.map((pred, index) => (
                                <div key={index} className="flex justify-between items-center text-sm">
                                    <span>{pred.date}</span>
                                    <div className="flex items-center gap-2">
                                        <span>Â¥{pred.price.toLocaleString()}</span>
                                        <span className="text-xs text-gray-500">({pred.confidence}%)</span>
                                    </div>
                                </div>
                            ))}
                        </div>
                    </div>
                </div>
            );
        };

        // Personalized Section Component
        const PersonalizedSection = ({ hotels, userSegment }) => {
            const segmentLabels = {
                couple: 'ã‚«ãƒƒãƒ—ãƒ«å‘ã‘',
                family: 'ãƒ•ã‚¡ãƒŸãƒªãƒ¼å‘ã‘',
                business: 'ãƒ“ã‚¸ãƒã‚¹å‘ã‘',
                luxury: 'é«˜ç´šå¿—å‘',
                budget: 'ç¯€ç´„é‡è¦–',
                solo: 'ä¸€äººæ—…',
                group: 'ã‚°ãƒ«ãƒ¼ãƒ—'
            };

            const reasonTagLabels = {
                room_capacity_match: 'éƒ¨å±‹ã‚¿ã‚¤ãƒ—ãŒæœ€é©',
                price_range_match: 'äºˆç®—ã«ãƒ”ãƒƒã‚¿ãƒª',
                spa: 'ã‚¹ãƒ‘ãƒ»æ¸©æ³‰ã‚ã‚Š',
                business_center: 'ãƒ“ã‚¸ãƒã‚¹è¨­å‚™å……å®Ÿ',
                family_rooms: 'ãƒ•ã‚¡ãƒŸãƒªãƒ¼ãƒ«ãƒ¼ãƒ ',
                location_preference: 'ç«‹åœ°ãŒè‰¯ã„',
                amenities_match: 'è¨­å‚™ãŒå……å®Ÿ'
            };

            return (
                <div className="bg-white rounded-lg shadow-lg p-6">
                    <div className="flex items-center gap-2 mb-4">
                        <h3 className="text-xl font-bold">ã‚ãªãŸå‘ã‘ã®ãŠã™ã™ã‚</h3>
                        <span className="px-2 py-1 bg-purple-100 text-purple-800 text-xs rounded">
                            {segmentLabels[userSegment]}
                        </span>
                    </div>

                    <div className="space-y-4">
                        {hotels.map((hotel, index) => (
                            <div key={index} className="border border-gray-200 rounded-lg p-4">
                                <div className="flex justify-between items-start mb-2">
                                    <div>
                                        <h4 className="font-semibold">{hotel.name}</h4>
                                        <p className="text-sm text-gray-600">{hotel.location}</p>
                                    </div>
                                    <div className="text-right">
                                        <div className="font-bold text-lg">Â¥{hotel.price.toLocaleString()}</div>
                                        <div className="text-xs text-purple-600">
                                            ãƒãƒƒãƒåº¦: {hotel.personalization_score}%
                                        </div>
                                    </div>
                                </div>

                                <div className="flex flex-wrap gap-1 mt-2">
                                    <span className="px-2 py-1 bg-red-100 text-red-800 text-xs rounded">
                                        ã‚ãªãŸå‘ã‘
                                    </span>
                                    {hotel.reason_tags?.map((tag, tagIndex) => (
                                        <span key={tagIndex} className="px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded">
                                            {reasonTagLabels[tag] || tag}
                                        </span>
                                    ))}
                                </div>
                            </div>
                        ))}
                    </div>
                </div>
            );
        };

        // Main App Component
        const App = () => {
            const [showWatchlist, setShowWatchlist] = useState(false);

            const mockHotel = {
                id: '1',
                name: 'ã‚¶ãƒ»ãƒªãƒƒãƒ„ãƒ»ã‚«ãƒ¼ãƒ«ãƒˆãƒ³æ±äº¬',
                price: 42000,
                location: 'æ±äº¬éƒ½æ¸¯åŒº'
            };

            const mockPersonalizedHotels = [
                {
                    ...mockHotel,
                    reason_tags: ['room_capacity_match', 'price_range_match', 'spa'],
                    personalization_score: 85,
                    is_personalized: true
                },
                {
                    id: '2',
                    name: 'ãƒ‘ãƒ¼ã‚¯ ãƒã‚¤ã‚¢ãƒƒãƒˆ æ±äº¬',
                    price: 29750,
                    location: 'æ±äº¬éƒ½æ–°å®¿åŒº',
                    reason_tags: ['business_center', 'family_rooms'],
                    personalization_score: 78,
                    is_personalized: true
                }
            ];

            const mockPredictions = [
                { date: '2025-07-05', price: 42000, confidence: 85 },
                { date: '2025-07-06', price: 45000, confidence: 78 },
                { date: '2025-07-07', price: 48000, confidence: 72 },
                { date: '2025-07-08', price: 44000, confidence: 80 },
                { date: '2025-07-09', price: 41000, confidence: 88 },
                { date: '2025-07-10', price: 39000, confidence: 92 },
                { date: '2025-07-11', price: 43000, confidence: 75 }
            ];

            return (
                <div className="min-h-screen bg-gray-50">
                    {/* Header */}
                    <header className="bg-white shadow-sm border-b">
                        <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                            <div className="flex justify-between items-center py-4">
                                <div className="flex items-center">
                                    <h1 className="text-2xl font-bold text-gray-900">ğŸ¨ LastMinuteStay</h1>
                                    <span className="ml-4 px-3 py-1 bg-green-100 text-green-800 rounded-full text-sm font-medium">
                                        æ–°æ©Ÿèƒ½å®Ÿè£…å®Œäº†
                                    </span>
                                </div>
                                <nav className="flex space-x-6">
                                    <a href="/" className="text-gray-700 hover:text-gray-900">ãƒ›ãƒ¼ãƒ </a>
                                    <a href="/features" className="text-gray-700 hover:text-gray-900">æ–°æ©Ÿèƒ½ãƒ‡ãƒ¢</a>
                                </nav>
                            </div>
                        </div>
                    </header>

                    {/* Hero Section */}
                    <div className="bg-gradient-to-r from-blue-600 to-purple-600 text-white py-16">
                        <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
                            <h2 className="text-4xl font-bold mb-4">
                                æ–°æ©Ÿèƒ½ãƒ‡ãƒ¢ãƒšãƒ¼ã‚¸
                            </h2>
                            <p className="text-xl mb-8">
                                âœ… ã‚¦ã‚©ãƒƒãƒãƒªã‚¹ãƒˆãƒ»ãƒ‘ãƒ¼ã‚½ãƒŠãƒ©ã‚¤ã‚¼ãƒ¼ã‚·ãƒ§ãƒ³ãƒ»ä¾¡æ ¼äºˆæ¸¬AIå®Ÿè£…å®Œäº†
                            </p>
                            <button
                                onClick={() => setShowWatchlist(true)}
                                className="bg-white text-blue-600 px-6 py-3 rounded-lg font-semibold hover:bg-gray-100 transition-colors"
                            >
                                ã‚¦ã‚©ãƒƒãƒãƒªã‚¹ãƒˆæ©Ÿèƒ½ã‚’ãƒ†ã‚¹ãƒˆ
                            </button>
                        </div>
                    </div>

                    {/* Content */}
                    <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12 space-y-12">
                        {/* Personalized Recommendations */}
                        <div>
                            <h2 className="text-2xl font-bold mb-6">1. ãƒ‘ãƒ¼ã‚½ãƒŠãƒ©ã‚¤ã‚ºãƒ‰ãƒ¬ã‚³ãƒ¡ãƒ³ãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³</h2>
                            <PersonalizedSection
                                hotels={mockPersonalizedHotels}
                                userSegment="couple"
                            />
                        </div>

                        {/* Price Prediction */}
                        <div>
                            <h2 className="text-2xl font-bold mb-6">2. ä¾¡æ ¼äºˆæ¸¬ãƒ»è³¼è²·ã‚¤ãƒ³ã‚¸ã‚±ãƒ¼ã‚¿ãƒ¼</h2>
                            <PricePrediction
                                currentPrice={42000}
                                predictions={mockPredictions}
                            />
                        </div>

                        {/* Implementation Status */}
                        <div className="bg-white rounded-lg shadow-lg p-8">
                            <h3 className="text-2xl font-bold text-gray-900 mb-6">ğŸ¯ å®Ÿè£…å®Œäº†æ©Ÿèƒ½</h3>
                            <div className="grid grid-cols-1 md:grid-cols-3 gap-6">
                                <div className="border-l-4 border-blue-500 pl-4">
                                    <h4 className="font-semibold text-gray-900">ã‚¦ã‚©ãƒƒãƒãƒªã‚¹ãƒˆæ©Ÿèƒ½</h4>
                                    <ul className="text-sm text-gray-600 mt-2 space-y-1">
                                        <li>âœ… ä¾¡æ ¼é–¾å€¤ãƒ»æ›œæ—¥æŒ‡å®šé€šçŸ¥</li>
                                        <li>âœ… æ®‹å®¤æ•°ã‚¢ãƒ©ãƒ¼ãƒˆ</li>
                                        <li>âœ… iCalã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼é€£æº</li>
                                        <li>âœ… 15åˆ†é–“éš”ç›£è¦–Cron</li>
                                    </ul>
                                </div>
                                <div className="border-l-4 border-green-500 pl-4">
                                    <h4 className="font-semibold text-gray-900">ãƒ‘ãƒ¼ã‚½ãƒŠãƒ©ã‚¤ã‚¼ãƒ¼ã‚·ãƒ§ãƒ³</h4>
                                    <ul className="text-sm text-gray-600 mt-2 space-y-1">
                                        <li>âœ… 7ã‚»ã‚°ãƒ¡ãƒ³ãƒˆè‡ªå‹•åˆ¤å®š</li>
                                        <li>âœ… ã€Œã‚ãªãŸå‘ã‘ã€ãƒãƒƒã‚¸</li>
                                        <li>âœ… ãƒ¬ã‚³ãƒ¡ãƒ³ãƒ‰ã‚¹ã‚³ã‚¢è¨ˆç®—</li>
                                        <li>âœ… ç†ç”±ã‚¿ã‚°ç”Ÿæˆ</li>
                                    </ul>
                                </div>
                                <div className="border-l-4 border-purple-500 pl-4">
                                    <h4 className="font-semibold text-gray-900">ä¾¡æ ¼äºˆæ¸¬AI</h4>
                                    <ul className="text-sm text-gray-600 mt-2 space-y-1">
                                        <li>âœ… çµ±è¨ˆçš„ä¾¡æ ¼äºˆæ¸¬</li>
                                        <li>âœ… 7æ—¥é–“æ¨ç§»äºˆæ¸¬</li>
                                        <li>âœ… ã€Œä»Šè²·ã†ã¹ãã€ã‚¤ãƒ³ã‚¸ã‚±ãƒ¼ã‚¿ãƒ¼</li>
                                        <li>âœ… MLç”¨ãƒ‡ãƒ¼ã‚¿åé›†</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>

                    {/* Watchlist Modal */}
                    {showWatchlist && (
                        <WatchlistModal
                            isOpen={showWatchlist}
                            onClose={() => setShowWatchlist(false)}
                            hotel={mockHotel}
                            onSave={(item) => {
                                console.log('Watchlist item saved:', item);
                                alert('ã‚¦ã‚©ãƒƒãƒãƒªã‚¹ãƒˆã«è¿½åŠ ã•ã‚Œã¾ã—ãŸï¼\\nï¼ˆãƒ‡ãƒ¢ãƒ¢ãƒ¼ãƒ‰ã®ãŸã‚å®Ÿéš›ã®é€šçŸ¥ã¯é€ä¿¡ã•ã‚Œã¾ã›ã‚“ï¼‰');
                                setShowWatchlist(false);
                            }}
                        />
                    )}
                </div>
            );
        };

        // Render the app
        ReactDOM.render(<App />, document.getElementById('root'));
    </script>
</body>
</html>